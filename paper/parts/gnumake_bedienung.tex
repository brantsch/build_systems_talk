% vim: spell spelllang=de
% vim: textwidth=80
\section{Bedienung und Konfiguration}

Bevor ein Projekt mit \texttt{make} automatisch erstellt werden kann, muss erst
die Konfiguration für selbiges in Form eines \texttt{Makefile} angelegt werden,
welches \texttt{make} darüber informiert, welche Dateien es wie aktualisieren
soll, abhängig von welchen anderen Dateien. GNU Make (und übrigens auch andere
Implementierungen von Make) werden in dem Verzeichnis in dem sie aufgerufen
werden nach einer Datei dieses Namens suchen und sie einlesen.
%
Ist diese Konfiguration erst ein mal vorhanden erfordert die Erstellung des
Projekts vom Benutzer nur noch mindestens einen Aufruf von \texttt{make}.

\subsection{Makefiles}

\subsubsection{Bestandteile}

\begin{description}
%
	\item[Regeln] Beschreiben wann und wie Dateien (\emph{Targets} der Regel)
	abhängig von \emph{Prerequisites} erstellt werden sollen.
	%
	\begin{description}
		\item[explizit] Targets benennen Dateien
		\item[implizit] Targets benennen Klassen von Dateien
	\end{description}
	%
%
	\item[Direktiven] unter anderem:
	%
	\begin{itemize}
		\item Einlesen anderer Makefiles
		\item Kontrollstrukturen für Entscheidungen
		\item Definition mehrzeiliger Variablen
	\end{itemize}
%
	\item[Variablendefinitionen] Zuweisungen von Zeichenketten zu Namen
%
	\item[Kommentare] von \texttt{make} zu ignorierender Text
\end{description}

\subsubsection*{Syntax}

\begin{description}
	%
	\item[Kommentare] \hspace{\fill} \input{../syntdiags/comments}
		
		Sobald \texttt{make} ein `\#'-Zeichen liest, ignoriert es den Rest der
		Zeile bis einschließlich des Zeilenumbruchs.
	%
	\item[Strings] \hspace{\fill} \input{../syntdiags/strings}

		Der einzige Datentyp den \texttt{make} unterstützt sind Strings.
	%
	\item[Funktionsaufrufe] \hspace{\fill} \input{../syntdiags/functioncalls}
		
		GNU Make stellt eine Sammlung von Hilfsfunktionen zur Verfügung, welche
		diversen Zwecken dienen, wie beispielsweise der Manipulation von
		Strings, der Umsetzung weiterer Bedingungs-Konstrukte, wiederholten
		Auswertung von Ausdrücken, etc.  \footnote{Siehe auch: Kapitel 8 (Functions
		for Transforming Text) in der offiziellen Dokumentation von GNU Make
		\citegnumakebib{GNU_Make_Manual}}
	%
	\item[Entscheidungs-Kontrollstrukturen]	\hspace{\fill}
	\input{../syntdiags/controlstructures}
	%
	\item[Bedingungen] \hspace{\fill} \input{../syntdiags/conditionals}
	%
	\item[Variablenreferenzen] \hspace{\fill} \input{../syntdiags/varref}

		\fcolorbox{red}{white}{
			\parbox{\linewidth-2\fboxsep}{
				Achtung: Referenzen auf undefinierte Variablen
				werden \emph{ohne Fehlermeldung} zu leeren Strings aufgelöst!
			}
		}
		
		Dieses Verhaltens sollte man sich bei der Fehlersuche in einem
		komplizierteren \texttt{Makefile} bewusst sein.
	%
	\item[Definition/Redefinition einer Variable] \hspace{\fill}
	\input{../syntdiags/vardef}

		\texttt{make} unterscheidet zwei Arten von Variablen, denen Werte
		explizit zugewiesen werden können: \emph{rekursiv expandierte Variablen}
		und \emph{einfach expandierte Variablen}.
		%
		Bei der Definition einer rekursiv expandierten Variable geschieht noch
		keinerlei Expansion von Variablenreferenzen. Diese erfolgt erst, wenn
		die Variable referenziert wird. Dann werden, wie der Name schon
		andeutet, Referenzen rekursiv expandiert.
		%
		Referenziert man hingegen in der Definition einer einfach expandierten
		Variable andere Variablen, so erfolgt die Expansion dieser Referenzen
		sofort. Gelegentlich ist das hilfreich, beispielsweise wenn man in der
		Definition einer Variable diese selbst referenzieren
		will\footnote{verwendete man eine rekursiv expandierte Variable
		entstünde hier eine Endlosschleife}, meistens werden aber normale,
		rekursiv expandierte Variablen genügen.
		
		Des Weiteren existieren auch sogenannte \emph{automatische Variablen},
		welche nicht explizit zugewiesen werden können, sondern ihre Werte von
		\texttt{make} erhalten.
	%
	\item[Anhängen an eine Variable] \hspace{\fill}
	\input{../syntdiags/varappend}
		
		Der aufmerksame Leser wird beim Lesen des Beispiel-\texttt{Makefile}s
		auf Seite~\pageref{subsubsection:examplemakefile} feststellen, dass
		auch das Anhängen an undefinierte Variablen möglich ist. Es hat den
		selben Effekt wie eine normale Zuweisung.

	\item[Regeln]
	
\end{description}
